<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ university.name }} - CollegeClue</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');

    /* Consistent Body Styles from Explore Colleges page */
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      color: #e0e0e0; /* Light text for dark background */
      font-weight: 500;
      /* Background from Explore Colleges page body */
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 30%, #0f3460 70%, #533483 100%);
      min-height: 100vh; /* Ensure full height for gradient */
    }

    /* Consistent Navigation Styles (from previous Explore Colleges page) */
    .nav-bar {
        background-color: rgba(30, 41, 59, 0.95); /* bg-gray-800/95 */
        -webkit-backdrop-filter: blur(8px);
        backdrop-filter: blur(8px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-lg */
        border-bottom: 1px solid rgba(75, 85, 99, 1); /* border-gray-700 */
    }

    /* Custom Button Styles (from your landing/explore pages) */
    .btn-primary {
        background: linear-gradient(135deg, #2d3748 0%, #4a5568 50%, #1a202c 100%);
        background-size: 200% 200%;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative;
        overflow: hidden;
        border-radius: 0.625rem; /* Equivalent to rounded-xl for consistency */
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: white; /* Ensure text is white */
    }

    .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.6s;
    }

    .btn-primary:hover::before {
        left: 100%;
    }

    .btn-primary:hover {
        background-position: 100% 0;
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 15px 35px rgba(45, 55, 72, 0.4);
    }

    /* Input/Select styling for dark theme (from previous Explore Colleges page) */
    .dark-input {
        background-color: #2d3748;
        color: #e0e0e0;
        border: 1px solid #4a5568;
        padding: 0.5rem 0.75rem; /* py-2 px-3 */
        border-radius: 0.375rem; /* rounded-md */
    }
    .dark-input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.5);
    }

    /* Accordion Custom Styles - Designed to mimic the 'card-hover' style of other pages */
    .accordion-section {
        background: #2d3748; /* Dark card background, similar to college-box */
        border-radius: 0.75rem; /* rounded-xl */
        margin-bottom: 1rem; /* mb-4 */
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
        border: 1px solid #4a5568; /* Subtle border */
        overflow: hidden; /* To keep border-radius on open content */
        transition: transform 0.2s ease, box-shadow 0.2s ease; /* Add hover transition */
    }

    .accordion-section:hover {
        transform: translateY(-5px); /* Lift slightly on hover */
        box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.2), 0 6px 10px -3px rgba(0, 0, 0, 0.1);
    }

    .accordion-header {
        padding: 1rem 1.5rem; /* py-4 px-6 */
        cursor: pointer;
        font-weight: 600; /* font-semibold */
        color: #ffffff; /* White text */
        background-color: #1a202c; /* Darker header background, consistent with nav */
        border-bottom: 1px solid #4a5568; /* Darker border */
        user-select: none;
        transition: background-color 0.3s ease;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 1.125rem; /* text-lg */
    }

    .accordion-header:hover {
        background-color: #2d3748; /* Slightly lighter on hover */
    }

    .accordion-header.open .accordion-icon {
        transform: rotate(90deg); /* Rotate icon when open */
    }

    .accordion-icon {
        transition: transform 0.3s ease;
        font-size: 1.5rem; /* text-2xl */
        line-height: 1; /* Ensure good alignment */
    }

    .accordion-content {
        padding: 1rem 1.5rem; /* py-4 px-6 */
        display: none;
        color: #e0e0e0; /* Light text for content */
    }

    /* Specific styles for lists inside accordions */
    .accordion-content ul {
      padding-left: 1.25rem; /* pl-5 */
      list-style-type: disc; /* bullet points */
      margin: 0;
    }
    .accordion-content li {
        margin-bottom: 0.5rem; /* mb-2 */
    }
    .accordion-content li:last-child {
        margin-bottom: 0;
    }

    .pg, .review {
      padding: 1rem; /* p-4 */
      background-color: #1a202c; /* Even darker card for nested items, matches nav */
      border: 1px solid #2d3748; /* Darker border */
      border-radius: 0.5rem; /* rounded-lg */
      margin-top: 1rem; /* mt-4 */
      color: #e0e0e0; /* Light text */
    }

    .pg strong, .review strong {
        color: #ffffff; /* White for strong text */
    }
    .pg ul {
      list-style-type: none; /* Remove default bullets for facility icons */
      padding-left: 0;
      margin-top: 0.5rem;
    }
    .pg ul li {
        margin-bottom: 0.25rem;
    }

    .map-link {
        display: inline-block;
        margin-top: 0.75rem; /* mt-3 */
        padding: 0.5rem 1rem; /* py-2 px-4 */
        background-color: #667eea; /* A nice blue for links, similar to accent colors */
        color: white;
        border-radius: 0.375rem; /* rounded-md */
        text-decoration: none;
        transition: background-color 0.3s ease;
        font-weight: 600;
    }

    .map-link:hover {
        background-color: #764ba2; /* Hover state for link button */
    }

    a {
      color: #667eea; /* Consistent link color for general text links */
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    /* University Title */
    .university-title {
        font-weight: 800; /* Extra bold */
        text-shadow: 0 4px 8px rgba(0,0,0,0.3); /* Soft shadow for prominence */
    }

    /* WhatsApp Button Styles */
    .whatsapp-button {
        position: fixed;
        bottom: 20px; /* Adjust as needed */
        right: 20px; /* Adjust as needed */
        background-color: #25D366; /* WhatsApp Green */
        color: white;
        border-radius: 50%; /* Make it round */
        width: 60px; /* Size of the button */
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        z-index: 1000; /* Ensure it's above other content */
        text-decoration: none; /* Remove underline */
    }

    .whatsapp-button:hover {
        transform: scale(1.1); /* Slightly enlarge on hover */
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    }

    .whatsapp-button img {
        width: 35px; /* Size of the WhatsApp icon inside the button */
        height: 35px;
    }

  </style>
</head>
<body class="page-gradient-bg">

<nav class="nav-bar h-16 flex items-center justify-between px-4 sm:px-6 lg:px-8">
    <div class="flex items-center">
        <h1 class="text-2xl font-bold text-white">CollegeClue</h1>
    </div>
    <div class="flex items-center space-x-4">
        <a href="{% url 'account_login' %}">
            <button class="btn-primary py-2 px-4 rounded-xl text-sm md:text-base">Login/Sign up</button>
        </a>
    </div>
</nav>

<div class="max-w-4xl mx-auto px-4 py-8">
    <div class="flex flex-col items-center mb-8">
        <img src="{{ university.image_url }}" alt="{{ university.name }}" class="w-28 h-28 rounded-full object-cover shadow-lg border-2 border-white mb-4">
        <h2 class="text-4xl sm:text-5xl university-title text-white text-center">{{ university.name }}</h2>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Basic Info
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          <li><strong>Location:</strong> {{ university.location }}</li>
          <li><strong>Accreditation:</strong> {{ university.accreditation }}</li>
          <li><strong>Type:</strong> {{ university.type }}</li>
          <li><strong>Campus Size:</strong> {{ university.campus_size }}</li>
          <li><strong>Tuition:</strong> {{ university.tuition }}</li>
          <li><strong>Established:</strong> {{ university.established_year }}</li>
          <li><strong>Undergraduate Enrollment:</strong> {{ university.undergraduate_enrollment }}</li>
          <li><strong>Graduate Enrollment:</strong> {{ university.graduate_enrollment }}</li>
          <li><strong>Average Salary:</strong> {{ university.average_salary }}</li>
          <li><strong>Study Abroad Programs:</strong> {{ university.study_abroad_programs|yesno:"Yes,No" }}</li>
          <li><strong>Financial Aid Available:</strong> {{ university.financial_aid_available|yesno:"Yes,No" }}</li>
          <li><strong>Website:</strong> <a href="{{ university.website }}" target="_blank">{{ university.website }}</a></li>
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Courses Offered
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          {% for course in university.courses.all %}
            <li>{{ course.course_name }}</li>
          {% empty %}
            <li class="text-gray-400">No courses listed.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Campus Facilities
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          {% for facility in university.facilities.all %}
            <li>{{ facility.name }}</li>
          {% empty %}
            <li class="text-gray-400">No facilities listed.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Nearby PGs
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <label for="genderFilter" class="block mb-2 text-white font-semibold">Filter by Gender:</label>
        <select id="genderFilter" onchange="filterPGs()" class="dark-input w-full md:w-auto">
          <option value="All">All</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Unisex">Unisex</option>
        </select>

        {% for pg in university.pgs.all %}
          <div class="pg" data-gender="{{ pg.gender }}"> {# Add data-gender attribute here #}
            <strong>{{ pg.name }}</strong><br>
            Address: {{ pg.address }}<br>
            Rent: ₹{{ pg.rent }}<br>
            Gender: {{ pg.gender }}<br>
            Food: {{ pg.food }}<br>
            Contact: {{ pg.contact }}<br>
            Facilities:
            <ul>
              {% for f in pg.facilities.all %}
                <li>
                  {% if "bed" in f.name|lower %}🛏️{% elif "food" in f.name|lower %}🍽️
                  {% elif "wifi" in f.name|lower %}📶{% elif "laundry" in f.name|lower %}🧺
                  {% elif "ac" in f.name|lower %}❄️{% endif %}
                  {{ f.name }}
                </li>
              {% endfor %}
            </ul>

            {% if university.latitude and university.longitude and pg.latitude and pg.longitude %}
              <a href="http://maps.google.com/maps?saddr={{ university.latitude }},{{ university.longitude }}&daddr={{ pg.latitude }},{{ pg.longitude }}"
                 target="_blank" class="map-link">
                📍 View Location
              </a>
            {% endif %}
          </div>
        {% empty %}
          <p class="text-gray-400 mt-4">No PGs listed.</p>
        {% endfor %}
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Top Recruiters
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          {% for recruiter in university.recruiters.all %}
            <li>{{ recruiter.name }}</li>
          {% empty %}
            <li class="text-gray-400">No recruiters listed.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Placement Record
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        {% if university.placement_record %}
          <ul>
            <li><strong>Average Salary:</strong> {{ university.placement_record.average_salary }}</li>
            <li><strong>Placement Percentage:</strong> {{ university.placement_record.placement_percentage }}</li>
          </ul>
        {% else %}
          <p class="text-gray-400">No placement record available.</p>
        {% endif %}
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Restaurants Nearby
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          {% for restaurant in university.restaurants.all %}
            <li>{{ restaurant.name }}</li>
          {% empty %}
            <li class="text-gray-400">No restaurants listed.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Hangout Places Nearby
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          {% for hangout in university.hangouts.all %}
            <li>{{ hangout.name }}</li>
          {% empty %}
            <li class="text-gray-400">No hangouts listed.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Transport Access
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        <ul>
          {% for transport in university.transports.all %}
            <li>{{ transport.type }}: {{ transport.distance }}</li>
          {% empty %}
            <li class="text-gray-400">No transport info available.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="accordion-section">
      <div class="accordion-header">
        Student Reviews
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content">
        {% for review in university.reviews.all %}
          <div class="review">
            <strong>{{ review.user_name }}</strong> (Rating: {{ review.rating }}/5)<br>
            {{ review.text }}
          </div>
        {% empty %}
          <p class="text-gray-400">No reviews yet.</p>
        {% endfor %}
      </div>
    </div>

    <div class="mt-10 flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
      <a href="{% url 'listofuniversities' %}" class="btn-primary py-3 px-6 font-bold">← Back to University List</a>
      <a href="{% url 'university_register' university.pk %}" class="btn-primary py-3 px-6 font-bold bg-green-600 hover:bg-green-700">Register</a>
    </div>

</div>

<a href="https://wa.me/919390352252?text=Hello%20CollegeClue%2C%20I%20have%20a%20question%20about%20a%20university."
   class="whatsapp-button"
   target="_blank"
   rel="noopener noreferrer">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/1200px-WhatsApp.svg.png" alt="WhatsApp Chat" />
</a>


<script>
  const headers = document.querySelectorAll('.accordion-header');
  headers.forEach(header => {
    header.addEventListener('click', () => {
      const content = header.nextElementSibling;
      const icon = header.querySelector('.accordion-icon');

      const isVisible = content.style.display === 'block';

      // Close all other open accordions
      document.querySelectorAll('.accordion-content').forEach(c => {
        if (c !== content && c.style.display === 'block') {
          c.style.display = 'none';
          c.previousElementSibling.classList.remove('open'); // Remove 'open' class from header
          c.previousElementSibling.querySelector('.accordion-icon').textContent = '+'; // Reset icon
        }
      });

      // Toggle current accordion
      if (isVisible) {
        content.style.display = 'none';
        header.classList.remove('open');
        icon.textContent = '+';
      } else {
        content.style.display = 'block';
        header.classList.add('open');
        icon.textContent = '−'; // Use minus sign for open
      }
    });
  });

  function filterPGs() {
    const selected = document.getElementById("genderFilter").value;
    document.querySelectorAll(".pg").forEach(pg => {
      // Correctly retrieve the data-gender attribute
      const gender = pg.getAttribute("data-gender");
      pg.style.display = (selected === "All" || gender === selected) ? "block" : "none";
    });
  }
</script>

</body>
</html>